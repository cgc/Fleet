\hypertarget{_numerics_8h}{}\section{src/\+Numerics.h File Reference}
\label{_numerics_8h}\index{src/\+Numerics.\+h@{src/\+Numerics.\+h}}
{\ttfamily \#include $<$random$>$}\newline
{\ttfamily \#include $<$iostream$>$}\newline
{\ttfamily \#include $<$assert.\+h$>$}\newline
Include dependency graph for Numerics.\+h\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=272pt]{_numerics_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_numerics_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef size\+\_\+t \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$typename T $>$ }\\T \hyperlink{_numerics_8h_a8b71b974f44117f5ce7f5d0a23feebde}{get\+\_\+log1pexp\+\_\+breakout\+\_\+bound} (const double precision, T f(T), const T lower=-\/1e6, const T upper=1e6)
\begin{DoxyCompactList}\small\item\em Tis takes a function f(x) and finds a bound B so that f(x) $<$ precision for all x $<$ B. This is useful in logsumexp where at compile time we don\textquotesingle{}t bother adding if the addition will be too tiny. For instance\+: constexpr auto f = +\mbox{[}\mbox{]}(T x) -\/$>$ const double \{return log1p(exp(x));\}; const T bound = get\+\_\+fx\+\_\+compiletime\+\_\+bound$<$\+T$>$(1e-\/6, f);. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename T $>$ }\\T \hyperlink{_numerics_8h_a558a1133b9942f8debd559bb9317bca3}{logplusexp} (const T a, const T b)
\item 
{\footnotesize template$<$typename t $>$ }\\double \hyperlink{_numerics_8h_abb96a05282957c6c5c3d226b357ed134}{logsumexp} (const t \&v)
\begin{DoxyCompactList}\small\item\em Compute log(sum(exp(v)). For now, this just unrolls logplusexp, but we might consider the faster (standard) variant where we pull out the max. \end{DoxyCompactList}\item 
std\+::pair$<$ \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t}, \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} $>$ \hyperlink{_numerics_8h_a80df2a7c0c7cb7ea93213d2998de3a92}{cantor\+\_\+decode} (const \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} z)
\item 
std\+::pair$<$ \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t}, \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} $>$ \hyperlink{_numerics_8h_a5376558a2cd1320415307932b4705a15}{rosenberg\+\_\+strong\+\_\+decode} (const \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} z)
\item 
\hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} \hyperlink{_numerics_8h_aca2b5ec9be38b05f995a1b27b1c41bfa}{rosenberg\+\_\+strong\+\_\+encode} (const \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} x, const \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} y)
\item 
std\+::pair$<$ \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t}, \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} $>$ \hyperlink{_numerics_8h_a85679187db301ca06541c7bf63edaaeb}{mod\+\_\+decode} (const \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} z, const \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} k)
\item 
\hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} \hyperlink{_numerics_8h_a956e43ece37e8290b0e3ee896a6d816c}{mod\+\_\+encode} (const \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} x, const \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} y, const \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} k)
\item 
\hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} \hyperlink{_numerics_8h_a20b6ceba89f804700d4aa26ce01088c1}{rosenberg\+\_\+strong\+\_\+pop} (\hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} \&z)
\item 
\hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} \hyperlink{_numerics_8h_a5e7d281df24734a0b311520519b5562b}{mod\+\_\+pop} (\hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} \&z, const \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} k)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const double \hyperlink{_numerics_8h_a63a7b698258aa319aacc36776054c7b5}{L\+O\+G05} = -\/log(2.\+0)
\item 
const double \hyperlink{_numerics_8h_a1bb1e42ae1b40cad6e99da0aab8a5576}{infinity} = std\+::numeric\+\_\+limits$<$double$>$\+::infinity()
\item 
const double \hyperlink{_numerics_8h_ab4ff070ea4fc5d50ffe530252867dc44}{NaN} = std\+::numeric\+\_\+limits$<$double$>$\+::quiet\+\_\+\+NaN()
\item 
const double \hyperlink{_numerics_8h_a43016d873124d39034edb8cd164794db}{pi} = M\+\_\+\+PI
\end{DoxyCompactItemize}


\subsection{Typedef Documentation}
\mbox{\Hypertarget{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}\label{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}} 
\index{Numerics.\+h@{Numerics.\+h}!enumerationidx\+\_\+t@{enumerationidx\+\_\+t}}
\index{enumerationidx\+\_\+t@{enumerationidx\+\_\+t}!Numerics.\+h@{Numerics.\+h}}
\subsubsection{\texorpdfstring{enumerationidx\+\_\+t}{enumerationidx\_t}}
{\footnotesize\ttfamily typedef size\+\_\+t \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t}}



\subsection{Function Documentation}
\mbox{\Hypertarget{_numerics_8h_a80df2a7c0c7cb7ea93213d2998de3a92}\label{_numerics_8h_a80df2a7c0c7cb7ea93213d2998de3a92}} 
\index{Numerics.\+h@{Numerics.\+h}!cantor\+\_\+decode@{cantor\+\_\+decode}}
\index{cantor\+\_\+decode@{cantor\+\_\+decode}!Numerics.\+h@{Numerics.\+h}}
\subsubsection{\texorpdfstring{cantor\+\_\+decode()}{cantor\_decode()}}
{\footnotesize\ttfamily std\+::pair$<$\hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t}, \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t}$>$ cantor\+\_\+decode (\begin{DoxyParamCaption}\item[{const \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t}}]{z }\end{DoxyParamCaption})}

\mbox{\Hypertarget{_numerics_8h_a8b71b974f44117f5ce7f5d0a23feebde}\label{_numerics_8h_a8b71b974f44117f5ce7f5d0a23feebde}} 
\index{Numerics.\+h@{Numerics.\+h}!get\+\_\+log1pexp\+\_\+breakout\+\_\+bound@{get\+\_\+log1pexp\+\_\+breakout\+\_\+bound}}
\index{get\+\_\+log1pexp\+\_\+breakout\+\_\+bound@{get\+\_\+log1pexp\+\_\+breakout\+\_\+bound}!Numerics.\+h@{Numerics.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+log1pexp\+\_\+breakout\+\_\+bound()}{get\_log1pexp\_breakout\_bound()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
T get\+\_\+log1pexp\+\_\+breakout\+\_\+bound (\begin{DoxyParamCaption}\item[{const double}]{precision,  }\item[{T }]{fT,  }\item[{const T}]{lower = {\ttfamily -\/1e6},  }\item[{const T}]{upper = {\ttfamily 1e6} }\end{DoxyParamCaption})}



Tis takes a function f(x) and finds a bound B so that f(x) $<$ precision for all x $<$ B. This is useful in logsumexp where at compile time we don\textquotesingle{}t bother adding if the addition will be too tiny. For instance\+: constexpr auto f = +\mbox{[}\mbox{]}(T x) -\/$>$ const double \{return log1p(exp(x));\}; const T bound = get\+\_\+fx\+\_\+compiletime\+\_\+bound$<$\+T$>$(1e-\/6, f);. 


\begin{DoxyItemize}
\item natural log on \mbox{[}0x1.\+f7a5ecp-\/127, 0x1.\+fffffep127\mbox{]}. Maximum relative error 9.\+4529e-\/5 $\ast$/ / From \href{https://stackoverflow.com/questions/39821367/very-fast-approximate-logarithm-natural-log-function-in-c}{\tt https\+://stackoverflow.\+com/questions/39821367/very-\/fast-\/approximate-\/logarithm-\/natural-\/log-\/function-\/in-\/c} 
\begin{DoxyParams}{Parameters}
{\em precision} & \\
\hline
{\em f} & \\
\hline
{\em lower} & \\
\hline
{\em upper} & \\
\hline
\end{DoxyParams}

\end{DoxyItemize}\mbox{\Hypertarget{_numerics_8h_a558a1133b9942f8debd559bb9317bca3}\label{_numerics_8h_a558a1133b9942f8debd559bb9317bca3}} 
\index{Numerics.\+h@{Numerics.\+h}!logplusexp@{logplusexp}}
\index{logplusexp@{logplusexp}!Numerics.\+h@{Numerics.\+h}}
\subsubsection{\texorpdfstring{logplusexp()}{logplusexp()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
T logplusexp (\begin{DoxyParamCaption}\item[{const T}]{a,  }\item[{const T}]{b }\end{DoxyParamCaption})}

\mbox{\Hypertarget{_numerics_8h_abb96a05282957c6c5c3d226b357ed134}\label{_numerics_8h_abb96a05282957c6c5c3d226b357ed134}} 
\index{Numerics.\+h@{Numerics.\+h}!logsumexp@{logsumexp}}
\index{logsumexp@{logsumexp}!Numerics.\+h@{Numerics.\+h}}
\subsubsection{\texorpdfstring{logsumexp()}{logsumexp()}}
{\footnotesize\ttfamily template$<$typename t $>$ \\
double logsumexp (\begin{DoxyParamCaption}\item[{const t \&}]{v }\end{DoxyParamCaption})}



Compute log(sum(exp(v)). For now, this just unrolls logplusexp, but we might consider the faster (standard) variant where we pull out the max. 


\begin{DoxyParams}{Parameters}
{\em v} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}
\mbox{\Hypertarget{_numerics_8h_a85679187db301ca06541c7bf63edaaeb}\label{_numerics_8h_a85679187db301ca06541c7bf63edaaeb}} 
\index{Numerics.\+h@{Numerics.\+h}!mod\+\_\+decode@{mod\+\_\+decode}}
\index{mod\+\_\+decode@{mod\+\_\+decode}!Numerics.\+h@{Numerics.\+h}}
\subsubsection{\texorpdfstring{mod\+\_\+decode()}{mod\_decode()}}
{\footnotesize\ttfamily std\+::pair$<$\hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t},\hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t}$>$ mod\+\_\+decode (\begin{DoxyParamCaption}\item[{const \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t}}]{z,  }\item[{const \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t}}]{k }\end{DoxyParamCaption})}

\mbox{\Hypertarget{_numerics_8h_a956e43ece37e8290b0e3ee896a6d816c}\label{_numerics_8h_a956e43ece37e8290b0e3ee896a6d816c}} 
\index{Numerics.\+h@{Numerics.\+h}!mod\+\_\+encode@{mod\+\_\+encode}}
\index{mod\+\_\+encode@{mod\+\_\+encode}!Numerics.\+h@{Numerics.\+h}}
\subsubsection{\texorpdfstring{mod\+\_\+encode()}{mod\_encode()}}
{\footnotesize\ttfamily \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} mod\+\_\+encode (\begin{DoxyParamCaption}\item[{const \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t}}]{x,  }\item[{const \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t}}]{y,  }\item[{const \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t}}]{k }\end{DoxyParamCaption})}

\mbox{\Hypertarget{_numerics_8h_a5e7d281df24734a0b311520519b5562b}\label{_numerics_8h_a5e7d281df24734a0b311520519b5562b}} 
\index{Numerics.\+h@{Numerics.\+h}!mod\+\_\+pop@{mod\+\_\+pop}}
\index{mod\+\_\+pop@{mod\+\_\+pop}!Numerics.\+h@{Numerics.\+h}}
\subsubsection{\texorpdfstring{mod\+\_\+pop()}{mod\_pop()}}
{\footnotesize\ttfamily \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} mod\+\_\+pop (\begin{DoxyParamCaption}\item[{\hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} \&}]{z,  }\item[{const \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t}}]{k }\end{DoxyParamCaption})}

\mbox{\Hypertarget{_numerics_8h_a5376558a2cd1320415307932b4705a15}\label{_numerics_8h_a5376558a2cd1320415307932b4705a15}} 
\index{Numerics.\+h@{Numerics.\+h}!rosenberg\+\_\+strong\+\_\+decode@{rosenberg\+\_\+strong\+\_\+decode}}
\index{rosenberg\+\_\+strong\+\_\+decode@{rosenberg\+\_\+strong\+\_\+decode}!Numerics.\+h@{Numerics.\+h}}
\subsubsection{\texorpdfstring{rosenberg\+\_\+strong\+\_\+decode()}{rosenberg\_strong\_decode()}}
{\footnotesize\ttfamily std\+::pair$<$\hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t}, \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t}$>$ rosenberg\+\_\+strong\+\_\+decode (\begin{DoxyParamCaption}\item[{const \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t}}]{z }\end{DoxyParamCaption})}

\mbox{\Hypertarget{_numerics_8h_aca2b5ec9be38b05f995a1b27b1c41bfa}\label{_numerics_8h_aca2b5ec9be38b05f995a1b27b1c41bfa}} 
\index{Numerics.\+h@{Numerics.\+h}!rosenberg\+\_\+strong\+\_\+encode@{rosenberg\+\_\+strong\+\_\+encode}}
\index{rosenberg\+\_\+strong\+\_\+encode@{rosenberg\+\_\+strong\+\_\+encode}!Numerics.\+h@{Numerics.\+h}}
\subsubsection{\texorpdfstring{rosenberg\+\_\+strong\+\_\+encode()}{rosenberg\_strong\_encode()}}
{\footnotesize\ttfamily \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} rosenberg\+\_\+strong\+\_\+encode (\begin{DoxyParamCaption}\item[{const \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t}}]{x,  }\item[{const \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t}}]{y }\end{DoxyParamCaption})}

\mbox{\Hypertarget{_numerics_8h_a20b6ceba89f804700d4aa26ce01088c1}\label{_numerics_8h_a20b6ceba89f804700d4aa26ce01088c1}} 
\index{Numerics.\+h@{Numerics.\+h}!rosenberg\+\_\+strong\+\_\+pop@{rosenberg\+\_\+strong\+\_\+pop}}
\index{rosenberg\+\_\+strong\+\_\+pop@{rosenberg\+\_\+strong\+\_\+pop}!Numerics.\+h@{Numerics.\+h}}
\subsubsection{\texorpdfstring{rosenberg\+\_\+strong\+\_\+pop()}{rosenberg\_strong\_pop()}}
{\footnotesize\ttfamily \hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} rosenberg\+\_\+strong\+\_\+pop (\begin{DoxyParamCaption}\item[{\hyperlink{_numerics_8h_a9fe2bbca873b046b2bd276fc6856bb88}{enumerationidx\+\_\+t} \&}]{z }\end{DoxyParamCaption})}



\subsection{Variable Documentation}
\mbox{\Hypertarget{_numerics_8h_a1bb1e42ae1b40cad6e99da0aab8a5576}\label{_numerics_8h_a1bb1e42ae1b40cad6e99da0aab8a5576}} 
\index{Numerics.\+h@{Numerics.\+h}!infinity@{infinity}}
\index{infinity@{infinity}!Numerics.\+h@{Numerics.\+h}}
\subsubsection{\texorpdfstring{infinity}{infinity}}
{\footnotesize\ttfamily const double infinity = std\+::numeric\+\_\+limits$<$double$>$\+::infinity()}

\mbox{\Hypertarget{_numerics_8h_a63a7b698258aa319aacc36776054c7b5}\label{_numerics_8h_a63a7b698258aa319aacc36776054c7b5}} 
\index{Numerics.\+h@{Numerics.\+h}!L\+O\+G05@{L\+O\+G05}}
\index{L\+O\+G05@{L\+O\+G05}!Numerics.\+h@{Numerics.\+h}}
\subsubsection{\texorpdfstring{L\+O\+G05}{LOG05}}
{\footnotesize\ttfamily const double L\+O\+G05 = -\/log(2.\+0)}

\mbox{\Hypertarget{_numerics_8h_ab4ff070ea4fc5d50ffe530252867dc44}\label{_numerics_8h_ab4ff070ea4fc5d50ffe530252867dc44}} 
\index{Numerics.\+h@{Numerics.\+h}!NaN@{NaN}}
\index{NaN@{NaN}!Numerics.\+h@{Numerics.\+h}}
\subsubsection{\texorpdfstring{NaN}{NaN}}
{\footnotesize\ttfamily const double NaN = std\+::numeric\+\_\+limits$<$double$>$\+::quiet\+\_\+\+NaN()}

\mbox{\Hypertarget{_numerics_8h_a43016d873124d39034edb8cd164794db}\label{_numerics_8h_a43016d873124d39034edb8cd164794db}} 
\index{Numerics.\+h@{Numerics.\+h}!pi@{pi}}
\index{pi@{pi}!Numerics.\+h@{Numerics.\+h}}
\subsubsection{\texorpdfstring{pi}{pi}}
{\footnotesize\ttfamily const double pi = M\+\_\+\+PI}


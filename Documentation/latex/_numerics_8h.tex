\hypertarget{_numerics_8h}{}\section{src/\+Numerics.h File Reference}
\label{_numerics_8h}\index{src/\+Numerics.\+h@{src/\+Numerics.\+h}}
{\ttfamily \#include $<$random$>$}\newline
{\ttfamily \#include $<$iostream$>$}\newline
{\ttfamily \#include $<$assert.\+h$>$}\newline
Include dependency graph for Numerics.\+h\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=272pt]{_numerics_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_numerics_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$typename T $>$ }\\T \hyperlink{_numerics_8h_a8b71b974f44117f5ce7f5d0a23feebde}{get\+\_\+log1pexp\+\_\+breakout\+\_\+bound} (const double precision, T f(T), const T lower=-\/1e6, const T upper=1e6)
\begin{DoxyCompactList}\small\item\em Tis takes a function f(x) and finds a bound B so that f(x) $<$ precision for all x $<$ B. This is useful in logsumexp where at compile time we don\textquotesingle{}t bother adding if the addition will be too tiny. For instance\+: constexpr auto f = +\mbox{[}\mbox{]}(T x) -\/$>$ const double \{return log1p(exp(x));\}; const T bound = get\+\_\+fx\+\_\+compiletime\+\_\+bound$<$\+T$>$(1e-\/6, f);. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename T $>$ }\\T \hyperlink{_numerics_8h_a558a1133b9942f8debd559bb9317bca3}{logplusexp} (const T a, const T b)
\item 
{\footnotesize template$<$typename t $>$ }\\double \hyperlink{_numerics_8h_abb96a05282957c6c5c3d226b357ed134}{logsumexp} (const t \&v)
\begin{DoxyCompactList}\small\item\em Compute log(sum(exp(v)). For now, this just unrolls logplusexp, but we might consider the faster (standard) variant where we pull out the max. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
constexpr double \hyperlink{_numerics_8h_a86b66aa18326dc4ebe8e36d253c14f40}{L\+O\+G2} = log(2.\+0)
\item 
constexpr double \hyperlink{_numerics_8h_af9434aea82baf2f6a5d9b6f9e36db08e}{infinity} = std\+::numeric\+\_\+limits$<$double$>$\+::infinity()
\item 
constexpr double \hyperlink{_numerics_8h_a23cd69b9bcaba6ec06598bc08ed5b6c3}{NaN} = std\+::numeric\+\_\+limits$<$double$>$\+::quiet\+\_\+\+NaN()
\item 
constexpr double \hyperlink{_numerics_8h_ad172e8d1a294401209781f9aeaa77410}{pi} = M\+\_\+\+PI
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{_numerics_8h_a8b71b974f44117f5ce7f5d0a23feebde}\label{_numerics_8h_a8b71b974f44117f5ce7f5d0a23feebde}} 
\index{Numerics.\+h@{Numerics.\+h}!get\+\_\+log1pexp\+\_\+breakout\+\_\+bound@{get\+\_\+log1pexp\+\_\+breakout\+\_\+bound}}
\index{get\+\_\+log1pexp\+\_\+breakout\+\_\+bound@{get\+\_\+log1pexp\+\_\+breakout\+\_\+bound}!Numerics.\+h@{Numerics.\+h}}
\subsubsection{\texorpdfstring{get\+\_\+log1pexp\+\_\+breakout\+\_\+bound()}{get\_log1pexp\_breakout\_bound()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
T get\+\_\+log1pexp\+\_\+breakout\+\_\+bound (\begin{DoxyParamCaption}\item[{const double}]{precision,  }\item[{T }]{fT,  }\item[{const T}]{lower = {\ttfamily -\/1e6},  }\item[{const T}]{upper = {\ttfamily 1e6} }\end{DoxyParamCaption})}



Tis takes a function f(x) and finds a bound B so that f(x) $<$ precision for all x $<$ B. This is useful in logsumexp where at compile time we don\textquotesingle{}t bother adding if the addition will be too tiny. For instance\+: constexpr auto f = +\mbox{[}\mbox{]}(T x) -\/$>$ const double \{return log1p(exp(x));\}; const T bound = get\+\_\+fx\+\_\+compiletime\+\_\+bound$<$\+T$>$(1e-\/6, f);. 


\begin{DoxyItemize}
\item natural log on \mbox{[}0x1.\+f7a5ecp-\/127, 0x1.\+fffffep127\mbox{]}. Maximum relative error 9.\+4529e-\/5 $\ast$/ / From \href{https://stackoverflow.com/questions/39821367/very-fast-approximate-logarithm-natural-log-function-in-c}{\tt https\+://stackoverflow.\+com/questions/39821367/very-\/fast-\/approximate-\/logarithm-\/natural-\/log-\/function-\/in-\/c} 
\begin{DoxyParams}{Parameters}
{\em precision} & \\
\hline
{\em f} & \\
\hline
{\em lower} & \\
\hline
{\em upper} & \\
\hline
\end{DoxyParams}

\end{DoxyItemize}\mbox{\Hypertarget{_numerics_8h_a558a1133b9942f8debd559bb9317bca3}\label{_numerics_8h_a558a1133b9942f8debd559bb9317bca3}} 
\index{Numerics.\+h@{Numerics.\+h}!logplusexp@{logplusexp}}
\index{logplusexp@{logplusexp}!Numerics.\+h@{Numerics.\+h}}
\subsubsection{\texorpdfstring{logplusexp()}{logplusexp()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
T logplusexp (\begin{DoxyParamCaption}\item[{const T}]{a,  }\item[{const T}]{b }\end{DoxyParamCaption})}

\mbox{\Hypertarget{_numerics_8h_abb96a05282957c6c5c3d226b357ed134}\label{_numerics_8h_abb96a05282957c6c5c3d226b357ed134}} 
\index{Numerics.\+h@{Numerics.\+h}!logsumexp@{logsumexp}}
\index{logsumexp@{logsumexp}!Numerics.\+h@{Numerics.\+h}}
\subsubsection{\texorpdfstring{logsumexp()}{logsumexp()}}
{\footnotesize\ttfamily template$<$typename t $>$ \\
double logsumexp (\begin{DoxyParamCaption}\item[{const t \&}]{v }\end{DoxyParamCaption})}



Compute log(sum(exp(v)). For now, this just unrolls logplusexp, but we might consider the faster (standard) variant where we pull out the max. 


\begin{DoxyParams}{Parameters}
{\em v} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}


\subsection{Variable Documentation}
\mbox{\Hypertarget{_numerics_8h_af9434aea82baf2f6a5d9b6f9e36db08e}\label{_numerics_8h_af9434aea82baf2f6a5d9b6f9e36db08e}} 
\index{Numerics.\+h@{Numerics.\+h}!infinity@{infinity}}
\index{infinity@{infinity}!Numerics.\+h@{Numerics.\+h}}
\subsubsection{\texorpdfstring{infinity}{infinity}}
{\footnotesize\ttfamily constexpr double infinity = std\+::numeric\+\_\+limits$<$double$>$\+::infinity()}

\mbox{\Hypertarget{_numerics_8h_a86b66aa18326dc4ebe8e36d253c14f40}\label{_numerics_8h_a86b66aa18326dc4ebe8e36d253c14f40}} 
\index{Numerics.\+h@{Numerics.\+h}!L\+O\+G2@{L\+O\+G2}}
\index{L\+O\+G2@{L\+O\+G2}!Numerics.\+h@{Numerics.\+h}}
\subsubsection{\texorpdfstring{L\+O\+G2}{LOG2}}
{\footnotesize\ttfamily constexpr double L\+O\+G2 = log(2.\+0)}

\mbox{\Hypertarget{_numerics_8h_a23cd69b9bcaba6ec06598bc08ed5b6c3}\label{_numerics_8h_a23cd69b9bcaba6ec06598bc08ed5b6c3}} 
\index{Numerics.\+h@{Numerics.\+h}!NaN@{NaN}}
\index{NaN@{NaN}!Numerics.\+h@{Numerics.\+h}}
\subsubsection{\texorpdfstring{NaN}{NaN}}
{\footnotesize\ttfamily constexpr double NaN = std\+::numeric\+\_\+limits$<$double$>$\+::quiet\+\_\+\+NaN()}

\mbox{\Hypertarget{_numerics_8h_ad172e8d1a294401209781f9aeaa77410}\label{_numerics_8h_ad172e8d1a294401209781f9aeaa77410}} 
\index{Numerics.\+h@{Numerics.\+h}!pi@{pi}}
\index{pi@{pi}!Numerics.\+h@{Numerics.\+h}}
\subsubsection{\texorpdfstring{pi}{pi}}
{\footnotesize\ttfamily constexpr double pi = M\+\_\+\+PI}

